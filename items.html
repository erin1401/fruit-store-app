<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Master Item â€” Juragan Buah</title>
  <link rel="stylesheet" href="styles.css">
</head>

<body class="fade-in">

<div class="sidebar">
  <h2>Juragan Buah</h2>
  <a href="dashboard.html">Dashboard</a>
  <a href="items.html" class="active">Master Item</a>
  <a href="buyers.html">Pembeli</a>
  <a href="stock-in.html">Item Masuk</a>
  <a href="stock-out.html">Item Keluar</a>
  <a href="opname.html">Stok Opname</a>
  <a href="sales.html">Penjualan</a>
  <a href="report-sales.html">Laporan Penjualan</a>
  <a href="report-stock.html">Laporan Persediaan</a>
  <a href="report-profit.html">Laba Rugi</a>
</div>

<div class="main">
  <div class="topbar">
     <div><img src="assets/logo.png" class="logo"> Master Item</div>
     <button class="btn" id="toggleDark">Mode</button>
  </div>

  <h2>Data Buah</h2>

  <div class="card">
      <table id="itemTable">
          <thead>
              <tr>
                  <th>Nama</th>
                  <th>Satuan</th>
                  <th>Harga</th>
                  <th>Aksi</th>
              </tr>
          </thead>
          <tbody></tbody>
      </table>
  </div>
</div>

<div class="fab" onclick="openModal('modalItem')">+</div>

<!-- Modal -->
<div id="modalItem" class="modal-bg">
  <div class="modal-box">
      <h3>Tambah Item</h3>

      <label>Nama Item</label>
      <input id="itemNama">

      <label>Satuan</label>
      <input id="itemSat">

      <label>Harga</label>
      <input id="itemHarga">

      <button class="btn" onclick="saveItem()">Simpan</button>
      <button class="btn btn-danger" onclick="closeModal('modalItem')">Batal</button>
  </div>
</div>

<div id="toast" class="toast"></div>

<script src="utils.js"></script>
<script src="data.js"></script>

<script>
function renderItems(){
   const list = load(KEY.ITEMS);
   itemTable.querySelector("tbody").innerHTML =
     list.map(x => `
       <tr>
         <td>${x.nama}</td>
         <td>${x.satuan}</td>
         <td>${num(x.harga)}</td>
         <td>
            <button class="btn btn-danger" onclick="deleteItem('${x.id}')">Hapus</button>
         </td>
       </tr>
     `).join("");
}

function saveItem(){
   addData(KEY.ITEMS, {
     id: newId("ITM"),
     nama: itemNama.value,
     satuan: itemSat.value,
     harga: Number(itemHarga.value)
   });

   closeModal("modalItem");
   toast("Item disimpan");
   renderItems();
}

function deleteItem(id){
   deleteData(KEY.ITEMS, id);
   toast("Item dihapus");
   renderItems();
}

renderItems();
</script>

</body>
</html>
